ğŸ¯ GOAL

I am building a production-grade GitHub-style Markdown Navigator for DSA learning, with strict API protection and quota control to prevent GitHub API exhaustion.

This is NOT a GitHub clone â€” it is inspired by GitHubâ€™s navigation and interaction patterns, but optimized for structured learning, not browsing.

ğŸ“ AUTHORITATIVE FILE TREE (CURRENT STATE)
app/
â”œâ”€ layout.tsx              # Global layout + theme bootstrap
â”œâ”€ page.tsx                # Entry â†’ mounts RepoShell
â”œâ”€ globals.css             # ONLY global CSS file

â”œâ”€ api/
â”‚ â”œâ”€ markdown/
â”‚ â”‚ â””â”€ route.ts            # ğŸ” Protected GitHub markdown fetch
â”‚ â”‚
â”‚ â”œâ”€ token/
â”‚ â”‚ â””â”€ route.ts            # Token bootstrap + validation (session-bound)
â”‚ â”‚
â”‚ â”œâ”€ admin/
â”‚ â”‚ â”œâ”€ login/
â”‚ â”‚ â”‚ â””â”€ route.ts          # Admin password login
â”‚ â”‚ â””â”€ tokens/
â”‚ â”‚   â””â”€ route.ts          # Admin token listing & mutation (SCAN-based)
â”‚
â”œâ”€ admin/
â”‚ â”œâ”€ login/
â”‚ â”‚ â””â”€ page.tsx            # Admin login UI
â”‚ â””â”€ dashboard/
â”‚   â””â”€ page.tsx            # Admin dashboard

components/
â”œâ”€ RepoShell.tsx            # SPA orchestrator (navigation, tour, split, revision)
â”œâ”€ RepoContent.tsx          # Markdown loader (calls /api/markdown)
â”œâ”€ RevisionMode.tsx         # Flashcard-style revision engine
â”œâ”€ Sidebar.tsx              # File tree navigation (NO fetch)
â”œâ”€ SidebarSearch.tsx        # Global search (Fuse.js, NO fetch)
â”œâ”€ TopNavbar.tsx            # Prev / Next + controls
â”œâ”€ TableOfContents.tsx      # TOC from markdown headings
â”œâ”€ MarkdownViewer.tsx       # GFM renderer
â”œâ”€ MarkdownSkeleton.tsx     # Loading placeholder
â”œâ”€ DrawOverlay.tsx          # Client-only drawing overlay
â”œâ”€ TokenEntryModal.tsx      # Token input modal
â”œâ”€ GlobalBlockedScreen.tsx  # Fullscreen blocked UX
â”œâ”€ InfoModal.tsx            # About / shortcuts / limits modal
â”‚
â”œâ”€ info/
â”‚ â”œâ”€ AboutThisApp.tsx       # Minimal app description (no philosophy)
â”‚ â”œâ”€ KeyboardShortcutsInfo.tsx # Desktop-only shortcut list
â”‚ â””â”€ FairUsageInfo.tsx      # Simplified fair usage explanation

lib/
â”œâ”€ redis.ts                 # Upstash Redis client
â””â”€ token.ts                 # ğŸ” Token system (quota + session lock)

middleware.ts               # Protects /admin + /api/admin routes

ğŸ§± CORE APP FEATURES (LOCKED â€” DO NOT BREAK)
ğŸ“‚ Navigation & UI

Sidebar-based file navigation

Folder expand / collapse

Active file highlighting

Auto-scroll to active file

Sidebar + TOC toggle

Global search (Fuse.js)

Keyboard-first UX

Mobile-safe behavior

SPA-style navigation using React state + URL hash

ZERO route remounts

Single scroll container (NO window scroll)

ğŸ“„ Markdown

GitHub-Flavored Markdown (GFM)

Copy buttons

Font zoom

Stable TOC with active section tracking

ğŸ“˜ Revision Mode

Flashcard-style learning

Front (Problem / Examples)

Back (Approach Code)

Keyboard navigation between approaches

Same access rules as Read mode

ğŸ”€ Split View (Desktop Only)

Vertical & horizontal split

Same SPA shell (shared activePath)

No duplicate GitHub fetches

Independent scroll containers

Resizable divider

Disabled on mobile

âœï¸ Draw Mode

Client-only overlay

No markdown mutation

Keyboard toggle (D)

ğŸ§­ ONBOARDING & INFO SYSTEM
Guided Tour

Shown only on first visit

Can be manually started from Info â†’ Start Guided Tour

Explains:

Sidebar navigation

Revision mode

Split view (desktop-only)

Draw mode

Search & TOC

Never forces UI state

Skips desktop-only steps on mobile

Info Modal

Tabs:

About this App

Keyboard Shortcuts

Fair Usage & Limits

Mobile behavior:

Single tab

Content stacked

Desktop behavior:

Sidebar tabs

Footer attribution only (no repeated authorship text)

ğŸ” ACCESS CONTROL SYSTEM (CORE FOCUS)
Identity Model

Each request is identified by:

x-dev-token â†’ access identity

x-session-id â†’ browser instance

A public token may be injected via:

NEXT_PUBLIC_PUBLIC_TOKEN


ALL GitHub API calls are backend-gated.

ğŸ§  TOKEN META (REDIS)
token:<token>:meta {
  name
  quotaScope    // session | token
  resetPolicy   // daily | never
  limit
  enabled
  createdAt
}

ğŸ§  SESSION LOCK (ANTI-SHARING)
token:<token>:active_session = <sessionId>


TTL-based sliding lock

Same session refreshes TTL

Different session â†’ BLOCKED (TOKEN_IN_USE)

ğŸ“Š QUOTA SYSTEM (CRITICAL)
quota:<scope>:<date | lifetime>


Where scope is:

session:<sessionId> OR

token:<token>

Rules:

Checked BEFORE GitHub fetch

Consumed ONLY AFTER successful fetch

Daily quotas expire via TTL

Lifetime quotas never expire

ğŸš« BLOCKED USER UX (MANDATORY)

Blocked states:

ok
blocked
awaiting_token


Rules:

Fullscreen blocked screen (no partial UI)

Reason always shown (from backend)

Actions:

Retry access

Enter token

Contact via LinkedIn

No skeletons
No silent failures

LinkedIn:
https://www.linkedin.com/in/tazeem-khan-662a24207/

ğŸ§‘â€ğŸ’» ADMIN SYSTEM
Admin Auth

Password-based

ADMIN_PASSWORD env

HTTP-only cookie

Protected by middleware

Admin Capabilities

List tokens (SCAN-based, no KEYS)

Create token

Enable / disable token

Reset quota

Delete token

Switch quota scope

ğŸš« HARD RULES (STRICT)

Before suggesting ANY change:

Ask for the relevant file(s)

Do NOT assume implementations

Do NOT invent missing code

Do NOT refactor architecture

Fix ONE thing at a time

Respect Redis free-tier limits

Do NOT break existing UX

Backend first, UI later